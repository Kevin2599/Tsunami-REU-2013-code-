
% 2  Previous Work
% 2.1  Problem setup picture(s) (which shows all variables)
% 2.2  Assumptions
% 2.3  NLSWEs ? derived from conservation of mass and Newton?s Second Law under assumptions (Just mention, not actually derive)
% 2.3.1  Mention that the SWEs have no dispersion ? there is very little dispersion near shore so this is where SWEs apply? fact check and/or more info
% 2.4  Very brief overview of how NLSWEs are linearized for arbitrary cross section
% 2.4.1  Properties of new system
% 2.4.2  Include equations to get back to physical variables
% 2.4.3  Analytical F(?) and thus W(?) for |y|^m case


\section{2012 REU}
	\begin{frame}
		\frametitle{Shallow-Water Wave Equations}
		Assuming that there is no lateral fluid motion:
		\begin{framed} \begin{align}
			\label{swe1} S_t + (uS)_x &= 0\\
			\label{swe2} u_t + u u_x + g H_x &= g h_x
		\end{align} \end{framed}
		%swe1 is conservation of mass
		%swe2 is conservation of momentum
		We have initial conditions that at $t=0$, $u(x,0) = 0$ and $\eta(x,0) = \eta_0(x)$, and boundary conditions that as $x$ becomes large, $u$ and $\eta$ become small, and that at the moving shoreline, $u(x,t)$ is bounded.
	\end{frame}

	\slide[Conversion to Matrices] {
		Noting that because $S(H) = \int_0^{H(x,t)} f(y) \delta y$, $S_t = S_H H_t$ and $S_x = S_H H_x$.
		\begin{align*}
			S_H H_t + S_H u H_x + S u_x &= 0\\
			u_t + g H_x + u u_x &= g h_x
		\end{align*}
		dividing the top equation by $S_H$, we have the following system
		\[
			\left [ \begin{array}{ccc} H \\ u \end{array} \right ]_t
			+ \left [ \begin{array}{ccc} u & S/S_H \\ g & u \end{array} \right ]
				\left [ \begin{array}{ccc} H \\ u \end{array} \right ]_x
			= \left [ \begin{array}{ccc} 0 \\ gh_x \end{array} \right ]
		\]
		which will be referred to as
		\begin{align}
			\label{sweMat1} v_t + X v_x = b
		\end{align}
	}
	\slide[Characteristic Equation] {
		Assuming there's a characteristic function $c(x,t)$
		\[v_s = v_x x_s + v_t t_s \]
		substituting in \eqref{sweMat1}
		\begin{align*}
			 v_s &= v_x x_s + (b - X v_x) t_s \\
			&= (I x_s - X t_s) v_x + b t_s
		\end{align*}
	}
	\slide[Eigenvectors] {
		If $(I x_s - X t_s)$ is nonsingular, then our solutions are trivial (zero). Thus, for non-trivial solutions
		\[ | I x_s - X t_s | = 0 \]
		then we can solve for $x_s$ (and define $c_\pm$)
		\[ x_s = (u \pm \sqrt{g S / S_H}) t_s = c_\pm t_s \]
		if we set $t_s = 1$
		\[ v_s = (c_\pm - X) v_x + b \]
		Eigenvector decomposition
		\[ V_\pm^\ast X = c_\pm V_\pm^\ast ,
			\qquad \text{where} V_\pm^\ast = \mat{ \pm \sqrt{g S_H / S} \\ 1} \]
	}
	\slide[Riemann Invariants] {
		The Riemann Inveriants are derived from the eigenvectors
		\[ V_\pm = \mat{ \pm \sqrt{g S_H / S} \\ 1} = \mat{I_H \\ I_u},
			\qquad I_\pm = u \pm \int \sqrt{g S_H / S} \cdot dH \]
		note that
		\[ V_\pm^\ast v_z = \mat {I_H & I_u} \mat{H \\ u}_z = I_H H_z + I_u u_z = I_z \]
		thus
		\begin{align*}
			V^\ast_\pm(v_t + X v_x) &= V_\pm^\ast b \\
			I_t + c_\pm I_x &= g h_x 
		\end{align*}
		we're using constant sloped bays, so $h=\alpha x$ and $h_x = \alpha$.
%		Letting $J_\pm = I_\pm - g \alpha t$,
		\begin{align}
			\label{rInvar} (\pderiv{}{t} + c_\pm \pderiv{}{x})(I_\pm - g \alpha t) &= 0
		\end{align}
	}
	\slide[Hodograph Transform] {
		The Hodograph transformation is an inversion of the variables in a Jacobian
		\begin{align*}
			\mat{{J_+}_x & {J_-}_x \\ {J_+}_t & {J_-}_t} \mat{x_{J_+} & t_{J_+} \\ x_{J_-} & t_{J_-}} &= \text{I}\\
			\mat{{J_+}_x & {J_-}_x \\ {J_+}_t & {J_-}_t} &= \mat{x_{J_+} & t_{J_+}\\ x_{J_-} & t_{J_-}}^{-1} \\
			\mat{{J_+}_x & {J_-}_x \\ {J_+}_t & {J_-}_t} &= 
				\frac{1}{|x_{J_+}  t_{J_-} - t_{J_+} x_{J_-}|} 
				\mat{t_{J_-} & -t_{J_+} \\ -x_{J_-} & x_{J_+}}
		\end{align*}
	}
	\slide[Hodograph Transform 2] {
		We can rewrite \eqref{rInvar}
		\[ (\pderiv{}{t} + c_\pm \pderiv{}{x})(I_\pm - g \alpha t) = 0 \]
		as
		\[ \mat{0 &0 \\0& 0} = \mat{1 & c_+ \\ 1 & c_-} \mat{{J_+}_t & {J_+}_x \\ {J_-}_t & {J_-}_x}\]
		so we apply the hodograph transform to get
		\[ \mat{0 &0\\ 0&0} = \mat{1 & c_+ \\ 1 & c_-} \mat{x_{J_-} & -x_{J_+} \\ -t_{J_-} & t_{J_+}}\]
		which can be rewritten as
		\[ \mat{ x_{J_+} \\ x_{J_-}} = {\mat{ c_- & 0 \\ 0 & c_+} \mat{t_{J_+} \\ t_{J_-}}} \]
	}
	\slide[Change of Variables] {
		We define two new variables
		\[
		\lambda = \frac{I_+ + I_-}{2} \qquad \sigma = \frac{I_+ - I_-}{2}.
		\]
		such that
		\[ \mat{\pderiv{}{J_+} \\ \pderiv{}{J_-}} = \mat{1 & 1 \\ 1 & -1} \mat{\pderiv{}{\lambda} \\ \pderiv{}{\sigma}} \]
		When we rewrite our equation in the new variables
		\[ \mat{ x_\lambda \\ x_\sigma} = \frac{1}{2} \mat{1 & 1 \\ 1 & -1} {\mat{ c_- & 0 \\ 0 & c_+}  \mat{1 & 1 \\ 1 & -1} 
			\mat{t_\lambda \\ t_\sigma}} \]
	}
	\slide[Change of Variables 2] {
		If we let 
			\[ \phi_\pm = \frac{1}{2}(c_- \pm c_+) \]
		then
			\[ \frac{1}{2} \mat{1 & 1 \\ 1 & -1} \mat{ c_- & 0 \\ 0 & c_+}  \mat{1 & 1 \\ 1 & -1} =
				\mat{\phi_+ & \phi_- \\ \phi_- & \phi_+} \]
		Remember that
			\[ c_\pm = u \pm \sqrt{g S / S_H} \qquad \lambda = u - \alpha g t \qquad \sigma = \int \sqrt{g S_H / S} dH\]
		so
			\[ \phi_+ = \lambda + \alpha g t \qquad \phi_- = \sqrt{g S / S_H} = - g H_\sigma = F(\sigma)\]
	}
	\slide[Final Equation] {
		Note that 
			\[ \mat{\phi_{+\sigma} & \phi_{+\lambda} \\ \phi_{-\sigma} & \phi_{-\lambda}} = 
				\mat{\alpha g t_\sigma & 1 + \alpha g t_\lambda \\ -F_\sigma & 0 } \]
		so
			\[ \mat{\pderiv{}{\sigma} & -\pderiv{}{\lambda}}
				\left ( \mat{ x_\lambda \\ x_\sigma} = \mat{\phi_+ & \phi_- \\ \phi_- & \phi_+} \mat{t_\lambda \\ t_\sigma} \right ) \]
		gives us
			\begin{align*}
				(\phi_{+\sigma} - \phi_{-\lambda})t_\lambda + (\phi_{-\sigma} - \phi_{+\lambda})t_\sigma +
					\phi_-(t_{\sigma\sigma} - t_{\lambda\lambda}) &= x_{\lambda \sigma} - x_{\sigma \lambda} \\
				\alpha g t_\sigma t_\lambda - 
					(F_\sigma + 1 + \alpha g t_\lambda)t_\sigma - F(t_{\sigma\sigma} - t_{\lambda\lambda}) &=0
			\end{align*}
			\begin{framed}
				\begin{align}
					\label{finaleq} t_{\lambda \lambda} - t_{\sigma \sigma} - \frac{(1 + F_\sigma)}{F} t_\sigma = 0
				\end{align}
			\end{framed}
	}
	
	\slide[How to think of the new Variables] {
		$\sigma =  \int \sqrt{g S_H / S} dH$ is the space variable.
		
		$\lambda = u - \alpha g t$ is roughly the time variable, warped by the wave speed.
		
		$F = \sqrt{g S / S_H}$ warps the space variable $\sigma$ to the bay shape.
	}



	\begin{frame}
		\frametitle{Backsubstituting to find $x$}
		In order to find $x$, we also obtain
			\[ g \alpha x_\sigma = \frac{F(\sigma)}{2} u_\lambda - \frac{F(\sigma)}{2} - u u_\sigma.\]
		To integrate this, we define a potential function $\Phi(\sigma,\lambda)$ such that
			\[ u = \frac{1}{F(\sigma)} \Phi_\sigma. \]
		Then we see that
		\[
		2 g \alpha x = \Phi_\lambda - \int_0^\sigma F(\sigma) d\sigma - u^2 = \Phi_\lambda - 2gH - u^2.
		\]
		Hence
		\[ \eta = H - h = H + \alpha x = \frac{1}{2g} \left(\Phi_\lambda - u^2 \right) \]
	\end{frame}

	\slide[Backsubstituting to Physical Variables]{
		Recall that 
			\[ \lambda = u - \alpha g t \]
		so we can solve for all physical variables:
		\begin{align*}
			u &= \frac{\Phi_\sigma}{F(\sigma)} \\
			\eta &= \frac{1}{2g} (\Phi_\lambda - u^2) \\
			x &= \frac{1}{2g\alpha} (\Phi_\lambda - 2gH - u^2 ) \\
			t &= \frac{\lambda - u}{\alpha g}
		\end{align*}
	}


	\begin{frame}
		\frametitle{Writing an Equation in Terms of $\Phi$}
		We substitute our definition of $\Phi$ into \eqref{finaleq} to obtain
		\begin{equation}\label{Phieq}
			\Phi_{\lambda \lambda} - \Phi_{\sigma} - W(\sigma) \Phi_\sigma = 0,
		\end{equation}
		where
		\[
			W(\sigma) = \frac{2 + F_\sigma}{F(\sigma)}.
		\]
	\end{frame}


	\begin{frame}
		\frametitle{Finding $F$ and $W$ for U-shaped bays}
		We need to find $F(\sigma)$ for the case of a U-shaped bay ($|y^m|$). Recalling that
		\[
			F(\sigma)= 2 \sqrt{gS \frac{dH}{dS}} \qquad \sigma = \int_0^H \sqrt{\frac{g}{S} \frac{dS}{dH}}dH.
		\]
		By integrating we can write $S(H)=2\frac{m}{m+1}H^{\frac{m+1}{m}}$ and also
		\[
			F(H)=2\sqrt{g} \sqrt{\frac{m}{m+1}} \sqrt{H} \text{ and } \sigma=2\sqrt{\frac{g(m+1)}{m}} H^{\frac12}
		\]
		So
			\[ F(\sigma)=\frac{m}{(m+1)\sigma} \]
		and
			\[ W(\sigma) = \frac{2 + F_\sigma}{F(\sigma)}=\frac{m+2}{m\sigma}. \]
	
	\end{frame}

