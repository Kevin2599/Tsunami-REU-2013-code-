u=Psiout(2,:)./F(2);
t=(lambda-u)/(alpha*g);
xp(1)=0;
xp(2)=u(2)*t(2);
for i=3:length(lambda)
	xp(i)=trapz(t(2:i),u(2:i));
end











 plot(xp)
hold on
plot(u,'r')

plot(t,'g')


index=0;
for i=1:length(t-1)
	if t(i+1)-t(i)<0
		index=i;
		break;
	end
end
if index~=0
	plot([index, index],[min([u t xp]) max([u t xp])],'k')
leg=legend('X_{shore} Approx','u','t','t_{break} Index');
else
 	leg=legend('X_{shore} Approx','u','t');%,'t_{break} Index');
end

xlabel('index')
ylabel('magnnitude')